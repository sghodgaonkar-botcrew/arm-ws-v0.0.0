\hypertarget{classIKSolverWithRWS}{}\doxysection{IKSolver\+With\+RWS Class Reference}
\label{classIKSolverWithRWS}\index{IKSolverWithRWS@{IKSolverWithRWS}}


Inverse Kinematics Solver with Reachable Workspace Support.  




{\ttfamily \#include $<$ik\+\_\+solver\+\_\+w\+\_\+rws.\+hpp$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classIKSolverWithRWS_a3f7699f375e1d77a11faab5726c3b4c0}{IKSolver\+With\+RWS}} (const std\+::string \&workspace\+\_\+dir, \mbox{\hyperlink{classRobotModel}{Robot\+Model}} \&robot\+\_\+model)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{workspace__types_8h_a050e523c0022a97c9b9646ced274bbda}{Joint\+Config}} \mbox{\hyperlink{classIKSolverWithRWS_a3dfcbdba1392f198179f72364105511e}{solve}} (const Eigen\+::\+Vector$<$ double, 7 $>$ \&target\+\_\+pose\+\_\+xyzquat)
\begin{DoxyCompactList}\small\item\em Solve IK for a target pose given as XYZQuat vector. \end{DoxyCompactList}\item 
\mbox{\hyperlink{workspace__types_8h_a050e523c0022a97c9b9646ced274bbda}{Joint\+Config}} \mbox{\hyperlink{classIKSolverWithRWS_a33d164fbbe438cb66911d0e7029b4806}{solve}} (const pinocchio\+::\+SE3 \&target\+\_\+pose)
\begin{DoxyCompactList}\small\item\em Solve IK for a target pose given as SE3 transform. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{classIKSolverWithRWS_ac2aa706124e78680c9b600f66c026ff9}{is\+Workspace\+Loaded}} () const
\begin{DoxyCompactList}\small\item\em Check if workspace data was successfully loaded. \end{DoxyCompactList}\item 
size\+\_\+t \mbox{\hyperlink{classIKSolverWithRWS_a827a268f052cc7ea2f1119396d6dfa43}{get\+Num\+Workspace\+Points}} () const
\begin{DoxyCompactList}\small\item\em Get the number of loaded workspace points. \end{DoxyCompactList}\item 
\mbox{\hyperlink{workspace__types_8h_a050e523c0022a97c9b9646ced274bbda}{Joint\+Config}} \mbox{\hyperlink{classIKSolverWithRWS_a35b8653eaf8b95ed8a2b03854ad62705}{solve\+\_\+ik}} (const Eigen\+::\+Vector$<$ double, 7 $>$ \&target\+\_\+pose\+\_\+xyzquat, const \mbox{\hyperlink{workspace__types_8h_a050e523c0022a97c9b9646ced274bbda}{Joint\+Config}} $\ast$q\+\_\+init=nullptr)
\begin{DoxyCompactList}\small\item\em Solve IK with explicit initial configuration. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static const int \mbox{\hyperlink{classIKSolverWithRWS_a72ac58b4f4c804448e5f44b89a8b9ef7}{MAX\+\_\+\+IK\+\_\+\+ITERATIONS}} = 1000
\begin{DoxyCompactList}\small\item\em Maximum number of iterations for IK optimization. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Inverse Kinematics Solver with Reachable Workspace Support. 

This class provides IK solving capabilities using pre-\/computed reachable workspace data for efficient warm-\/start initialization. The solver implements a sophisticated two-\/stage approach\+:


\begin{DoxyEnumerate}
\item {\bfseries{Warm-\/start Initialization}}\+: Uses nearest neighbor search in pre-\/computed workspace data to find good initial joint configurations close to the target pose. This significantly improves convergence speed and success rate.
\item {\bfseries{Iterative Refinement}}\+: Uses quadratic programming with line search to refine the initial configuration and achieve precise pose matching.
\end{DoxyEnumerate}

The workspace data is loaded from binary files containing\+:
\begin{DoxyItemize}
\item K-\/d tree data\+: sampled workspace points with positions, orientations, and joint configs
\item Voxel grid data\+: spatial indexing structure for fast neighbor search
\end{DoxyItemize}

{\bfseries{Control Flow Overview\+:}}
\begin{DoxyEnumerate}
\item Constructor loads workspace data from files
\item \mbox{\hyperlink{classIKSolverWithRWS_a3dfcbdba1392f198179f72364105511e}{solve()}} method performs nearest neighbor search for warm-\/start
\item \mbox{\hyperlink{classIKSolverWithRWS_a35b8653eaf8b95ed8a2b03854ad62705}{solve\+\_\+ik()}} method performs iterative optimization using QP
\item Line search ensures convergence and prevents overshooting
\end{DoxyEnumerate}

{\bfseries{Key Features\+:}}
\begin{DoxyItemize}
\item Fast warm-\/start using spatial indexing
\item Robust convergence with line search
\item Joint limit enforcement
\item Comprehensive error handling
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classRobotModel}{Robot\+Model}} 

\mbox{\hyperlink{structWorkspacePoint}{Workspace\+Point}} 

\mbox{\hyperlink{structVoxelGrid}{Voxel\+Grid}} 
\end{DoxySeeAlso}


\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classIKSolverWithRWS_a3f7699f375e1d77a11faab5726c3b4c0}\label{classIKSolverWithRWS_a3f7699f375e1d77a11faab5726c3b4c0}} 
\index{IKSolverWithRWS@{IKSolverWithRWS}!IKSolverWithRWS@{IKSolverWithRWS}}
\index{IKSolverWithRWS@{IKSolverWithRWS}!IKSolverWithRWS@{IKSolverWithRWS}}
\doxysubsubsection{\texorpdfstring{IKSolverWithRWS()}{IKSolverWithRWS()}}
{\footnotesize\ttfamily IKSolver\+With\+RWS\+::\+IKSolver\+With\+RWS (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{workspace\+\_\+dir,  }\item[{\mbox{\hyperlink{classRobotModel}{Robot\+Model}} \&}]{robot\+\_\+model }\end{DoxyParamCaption})}



Constructor. 

Constructor implementation.


\begin{DoxyParams}{Parameters}
{\em workspace\+\_\+dir} & Directory containing generated workspace data files \\
\hline
{\em robot\+\_\+model} & Reference to the robot model for IK solving\\
\hline
\end{DoxyParams}
{\bfseries{Constructor Flow\+:}}
\begin{DoxyEnumerate}
\item Store workspace directory and robot model references
\item Find and load the latest k-\/d tree data file
\item Find and load the latest voxel grid data file
\item Verify data integrity and print loading statistics
\item Initialize voxel grid loaded flag
\end{DoxyEnumerate}

{\bfseries{Error Handling\+:}}
\begin{DoxyItemize}
\item Throws runtime\+\_\+error if no workspace data files are found
\item Throws runtime\+\_\+error if data loading fails
\item Provides detailed error messages for debugging
\end{DoxyItemize}


\begin{DoxyExceptions}{Exceptions}
{\em std\+::runtime\+\_\+error} & if workspace data cannot be loaded\\
\hline
\end{DoxyExceptions}
{\bfseries{Constructor Flow\+:}}
\begin{DoxyEnumerate}
\item Initialize member variables and set voxel grid loaded flag to false
\item Find and load the latest k-\/d tree data file
\item Verify k-\/d tree data was loaded successfully
\item Find and load the latest voxel grid data file
\item Verify voxel grid data was loaded successfully
\item Set voxel grid loaded flag to true
\item Print loading statistics for verification
\end{DoxyEnumerate}

{\bfseries{Error Handling\+:}}
\begin{DoxyItemize}
\item Throws runtime\+\_\+error if no k-\/d tree files found
\item Throws runtime\+\_\+error if k-\/d tree data loading fails
\item Throws runtime\+\_\+error if no voxel grid files found
\item Throws runtime\+\_\+error if voxel grid data loading fails
\end{DoxyItemize}

{\bfseries{Data Loading Strategy\+:}}
\begin{DoxyItemize}
\item Automatically finds the most recent data files by modification time
\item Provides detailed error messages for debugging
\item Ensures data integrity before proceeding 
\end{DoxyItemize}

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classIKSolverWithRWS_a827a268f052cc7ea2f1119396d6dfa43}\label{classIKSolverWithRWS_a827a268f052cc7ea2f1119396d6dfa43}} 
\index{IKSolverWithRWS@{IKSolverWithRWS}!getNumWorkspacePoints@{getNumWorkspacePoints}}
\index{getNumWorkspacePoints@{getNumWorkspacePoints}!IKSolverWithRWS@{IKSolverWithRWS}}
\doxysubsubsection{\texorpdfstring{getNumWorkspacePoints()}{getNumWorkspacePoints()}}
{\footnotesize\ttfamily size\+\_\+t IKSolver\+With\+RWS\+::get\+Num\+Workspace\+Points (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Get the number of loaded workspace points. 

\begin{DoxyReturn}{Returns}
Number of workspace points
\end{DoxyReturn}
This method provides information about the size of the loaded workspace data, which can be useful for debugging and performance analysis. \mbox{\Hypertarget{classIKSolverWithRWS_ac2aa706124e78680c9b600f66c026ff9}\label{classIKSolverWithRWS_ac2aa706124e78680c9b600f66c026ff9}} 
\index{IKSolverWithRWS@{IKSolverWithRWS}!isWorkspaceLoaded@{isWorkspaceLoaded}}
\index{isWorkspaceLoaded@{isWorkspaceLoaded}!IKSolverWithRWS@{IKSolverWithRWS}}
\doxysubsubsection{\texorpdfstring{isWorkspaceLoaded()}{isWorkspaceLoaded()}}
{\footnotesize\ttfamily bool IKSolver\+With\+RWS\+::is\+Workspace\+Loaded (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Check if workspace data was successfully loaded. 

\begin{DoxyReturn}{Returns}
true if workspace data is available, false otherwise
\end{DoxyReturn}
This method can be used to verify that the solver was properly initialized with workspace data before attempting IK solving. \mbox{\Hypertarget{classIKSolverWithRWS_a3dfcbdba1392f198179f72364105511e}\label{classIKSolverWithRWS_a3dfcbdba1392f198179f72364105511e}} 
\index{IKSolverWithRWS@{IKSolverWithRWS}!solve@{solve}}
\index{solve@{solve}!IKSolverWithRWS@{IKSolverWithRWS}}
\doxysubsubsection{\texorpdfstring{solve()}{solve()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{workspace__types_8h_a050e523c0022a97c9b9646ced274bbda}{Joint\+Config}} IKSolver\+With\+RWS\+::solve (\begin{DoxyParamCaption}\item[{const Eigen\+::\+Vector$<$ double, 7 $>$ \&}]{target\+\_\+pose\+\_\+xyzquat }\end{DoxyParamCaption})}



Solve IK for a target pose given as XYZQuat vector. 

Solve IK for target pose given as XYZQuat vector.


\begin{DoxyParams}{Parameters}
{\em target\+\_\+pose\+\_\+xyzquat} & Target pose as \mbox{[}x, y, z, qx, qy, qz, qw\mbox{]} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Joint configuration that achieves the target pose
\end{DoxyReturn}
{\bfseries{Method Flow\+:}}
\begin{DoxyEnumerate}
\item Extract translation (xyz) and rotation (quaternion) from input
\item Normalize quaternion to ensure unit length
\item Perform nearest neighbor search using voxel grid for efficiency
\item Select best initial configuration based on rotation error
\item Normalize joint angles to \mbox{[}-\/π, π\mbox{]} range
\item Call \mbox{\hyperlink{classIKSolverWithRWS_a35b8653eaf8b95ed8a2b03854ad62705}{solve\+\_\+ik()}} with warm-\/start configuration
\end{DoxyEnumerate}

{\bfseries{Neighbor Selection Logic\+:}}
\begin{DoxyItemize}
\item Uses geodesic distance for rotation error calculation
\item Selects configuration with minimum rotation error
\item Falls back to current joint config if no neighbors found
\end{DoxyItemize}

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classIKSolverWithRWS_a35b8653eaf8b95ed8a2b03854ad62705}{solve\+\_\+ik()}}
\end{DoxySeeAlso}
{\bfseries{Method Flow\+:}}
\begin{DoxyEnumerate}
\item {\bfseries{Input Processing}}\+: Extract translation and rotation from XYZQuat input
\item {\bfseries{Quaternion Normalization}}\+: Ensure unit quaternion for numerical stability
\item {\bfseries{Nearest Neighbor Search}}\+: Use voxel grid for efficient spatial search
\item {\bfseries{Warm-\/start Selection}}\+: Choose best initial configuration based on rotation error
\item {\bfseries{Joint Angle Normalization}}\+: Wrap angles to \mbox{[}-\/π, π\mbox{]} range
\item {\bfseries{IK Solving}}\+: Call core IK solver with warm-\/start configuration
\end{DoxyEnumerate}

{\bfseries{Neighbor Selection Logic\+:}}
\begin{DoxyItemize}
\item Uses geodesic distance (2$\ast$acos($\vert$q1·q2$\vert$)) for rotation error
\item Selects configuration with minimum rotation error
\item Falls back to current joint config if no neighbors found
\item Provides detailed logging of selection process
\end{DoxyItemize}

{\bfseries{Performance Optimizations\+:}}
\begin{DoxyItemize}
\item Uses voxel grid for O(1) spatial indexing
\item Searches for 20 neighbors to ensure good coverage
\item Normalizes quaternions to prevent numerical issues 
\end{DoxyItemize}\mbox{\Hypertarget{classIKSolverWithRWS_a33d164fbbe438cb66911d0e7029b4806}\label{classIKSolverWithRWS_a33d164fbbe438cb66911d0e7029b4806}} 
\index{IKSolverWithRWS@{IKSolverWithRWS}!solve@{solve}}
\index{solve@{solve}!IKSolverWithRWS@{IKSolverWithRWS}}
\doxysubsubsection{\texorpdfstring{solve()}{solve()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{workspace__types_8h_a050e523c0022a97c9b9646ced274bbda}{Joint\+Config}} IKSolver\+With\+RWS\+::solve (\begin{DoxyParamCaption}\item[{const pinocchio\+::\+SE3 \&}]{target\+\_\+pose }\end{DoxyParamCaption})}



Solve IK for a target pose given as SE3 transform. 

Solve IK for target pose given as SE3 transform.


\begin{DoxyParams}{Parameters}
{\em target\+\_\+pose} & Target pose as SE3 transform \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Joint configuration that achieves the target pose
\end{DoxyReturn}
{\bfseries{Method Flow\+:}}
\begin{DoxyEnumerate}
\item Convert SE3 transform to XYZQuat format using \mbox{\hyperlink{classRobotModel}{Robot\+Model}} utility
\item Call the XYZQuat version of \mbox{\hyperlink{classIKSolverWithRWS_a3dfcbdba1392f198179f72364105511e}{solve()}}
\end{DoxyEnumerate}

This method provides a convenient interface for users working with Pinocchio SE3 transforms.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classIKSolverWithRWS_a3dfcbdba1392f198179f72364105511e}{solve(const Eigen\+::\+Vector$<$double, 7$>$\&)}}
\end{DoxySeeAlso}
{\bfseries{Method Flow\+:}}
\begin{DoxyEnumerate}
\item Convert SE3 transform to XYZQuat format using \mbox{\hyperlink{classRobotModel}{Robot\+Model}} utility
\item Call the XYZQuat version of \mbox{\hyperlink{classIKSolverWithRWS_a3dfcbdba1392f198179f72364105511e}{solve()}}
\end{DoxyEnumerate}

This method provides a convenient interface for users working with Pinocchio SE3 transforms, automatically handling the conversion. \mbox{\Hypertarget{classIKSolverWithRWS_a35b8653eaf8b95ed8a2b03854ad62705}\label{classIKSolverWithRWS_a35b8653eaf8b95ed8a2b03854ad62705}} 
\index{IKSolverWithRWS@{IKSolverWithRWS}!solve\_ik@{solve\_ik}}
\index{solve\_ik@{solve\_ik}!IKSolverWithRWS@{IKSolverWithRWS}}
\doxysubsubsection{\texorpdfstring{solve\_ik()}{solve\_ik()}}
{\footnotesize\ttfamily \mbox{\hyperlink{workspace__types_8h_a050e523c0022a97c9b9646ced274bbda}{Joint\+Config}} IKSolver\+With\+RWS\+::solve\+\_\+ik (\begin{DoxyParamCaption}\item[{const Eigen\+::\+Vector$<$ double, 7 $>$ \&}]{target\+\_\+pose\+\_\+xyzquat,  }\item[{const \mbox{\hyperlink{workspace__types_8h_a050e523c0022a97c9b9646ced274bbda}{Joint\+Config}} $\ast$}]{q\+\_\+init = {\ttfamily nullptr} }\end{DoxyParamCaption})}



Solve IK with explicit initial configuration. 

Solve IK with explicit initial configuration for XYZQuat input.


\begin{DoxyParams}{Parameters}
{\em target\+\_\+pose\+\_\+xyzquat} & Target pose as \mbox{[}x, y, z, qx, qy, qz, qw\mbox{]} \\
\hline
{\em q\+\_\+init} & Optional initial joint configuration (nullptr for current config) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Joint configuration that achieves the target pose
\end{DoxyReturn}
This method allows users to provide their own initial configuration instead of using the automatic warm-\/start selection.

\begin{DoxySeeAlso}{See also}
solve\+\_\+ik(const pinocchio\+::\+SE3\&, const Joint\+Config$\ast$)
\end{DoxySeeAlso}
{\bfseries{Method Flow\+:}}
\begin{DoxyEnumerate}
\item Convert XYZQuat input to SE3 transform
\item Normalize quaternion to ensure unit length
\item Call the SE3 version of \mbox{\hyperlink{classIKSolverWithRWS_a35b8653eaf8b95ed8a2b03854ad62705}{solve\+\_\+ik()}}
\item Print final pose in XYZQuat format for verification
\end{DoxyEnumerate}

This method provides a convenient interface for users who prefer XYZQuat format and want to specify their own initial configuration. 

\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classIKSolverWithRWS_a72ac58b4f4c804448e5f44b89a8b9ef7}\label{classIKSolverWithRWS_a72ac58b4f4c804448e5f44b89a8b9ef7}} 
\index{IKSolverWithRWS@{IKSolverWithRWS}!MAX\_IK\_ITERATIONS@{MAX\_IK\_ITERATIONS}}
\index{MAX\_IK\_ITERATIONS@{MAX\_IK\_ITERATIONS}!IKSolverWithRWS@{IKSolverWithRWS}}
\doxysubsubsection{\texorpdfstring{MAX\_IK\_ITERATIONS}{MAX\_IK\_ITERATIONS}}
{\footnotesize\ttfamily const int IKSolver\+With\+RWS\+::\+MAX\+\_\+\+IK\+\_\+\+ITERATIONS = 1000\hspace{0.3cm}{\ttfamily [static]}}



Maximum number of iterations for IK optimization. 

This constant limits the number of iterations in the iterative IK solver to prevent infinite loops and ensure reasonable computation time. The solver typically converges in much fewer iterations (10-\/50). 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/shanto/\+Documents/arm-\/ws-\/v0.\+0.\+0/dds\+\_\+bridge/cpp\+\_\+plugins/include/\mbox{\hyperlink{ik__solver__w__rws_8hpp}{ik\+\_\+solver\+\_\+w\+\_\+rws.\+hpp}}\item 
/home/shanto/\+Documents/arm-\/ws-\/v0.\+0.\+0/dds\+\_\+bridge/cpp\+\_\+plugins/src/\mbox{\hyperlink{ik__solver__w__rws_8cpp}{ik\+\_\+solver\+\_\+w\+\_\+rws.\+cpp}}\end{DoxyCompactItemize}
